<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>CrÃ©er un compte Ã  rebours</title>
	
	<!-- CSS EXTERNE -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">
</head>
<body>

<div class="page-wrapper">
  <!-- HEADER -->
  <header class="header">
    <div class="header-left">
      <div class="title-row">
        <span>ğŸ•’ Countdown Studio</span>
        <span class="pill">Multi-templates â€¢ Email ready</span>
      </div>
      <div class="subtitle">
        Configure ton compte Ã  rebours, visualise le rendu en live, puis rÃ©cupÃ¨re un lien GIF dynamique prÃªt Ã  intÃ©grer dans tes emails.
      </div>
    </div>
    <div class="header-actions">
      <a href="/admin" class="btn-ghost"><span class="icon">ğŸ”</span>Admin</a>
      <a href="/list" class="btn-ghost"><span class="icon">ğŸ“‹</span>Liste</a>
    </div>
  </header>
	
	<!-- LAYOUT 2 COLONNES -->
  <div class="layout">

    <!-- COLONNE GAUCHE : FORMULAIRE -->
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">
            <div class="card-title-icon">ğŸ›</div>
            Configurer un nouveau countdown
          </div>
          <div class="card-subtitle">
            Tous les paramÃ¨tres sont enregistrÃ©s dans un ID unique. Chaque crÃ©ation gÃ©nÃ¨re un GIF indÃ©pendant.
          </div>
        </div>
      </div>

      <form method="POST" id="configForm">

        <!-- GÃ‰NÃ‰RAL -->
        <div class="form-group full">
          <label>Date cible <span class="hint">Obligatoire</span></label>
          <input type="datetime-local" name="target_date" id="target_date" value="{{ target_date }}" required>
        </div>

        <div class="form-group">
          <label>Template <span class="hint">Style global</span></label>
          <select name="template" id="template">
            <option value="classic"  {% if config.template == 'classic'  %}selected{% endif %}>Classic</option>
	          <option value="blocks"   {% if config.template == 'blocks'   %}selected{% endif %}>Blocks</option>
	          <option value="flip"     {% if config.template == 'flip'     %}selected{% endif %}>Flip clock</option>
	          <option value="bubble"   {% if config.template == 'bubble'   %}selected{% endif %}>Bubble</option>
	          <option value="minimal"  {% if config.template == 'minimal'  %}selected{% endif %}>Minimal</option>
	          <option value="banner"   {% if config.template == 'banner'   %}selected{% endif %}>Banner</option>
	          <option value="progress" {% if config.template == 'progress' %}selected{% endif %}>Progress bar</option>
          </select>
        </div>

        <div class="form-group">
          <label>Alignement</label>
          <select name="alignment" id="alignment">
            <option value="left"   {% if config.alignment == 'left'   %}selected{% endif %}>Gauche</option>
	          <option value="center" {% if config.alignment == 'center' %}selected{% endif %}>CentrÃ©</option>
	          <option value="right"  {% if config.alignment == 'right'  %}selected{% endif %}>Droite</option>
          </select>
        </div>

        <div class="form-group">
          <label>Couleur de fond</label>
          <input type="color" name="background_color" id="background_color" value="{{ config.background_color }}">
        </div>

        <div class="form-group">
          <label>Couleur du texte</label>
          <input type="color" name="text_color" id="text_color" value="{{ config.text_color }}">
        </div>

        <div class="form-group">
          <label>Taille du texte</label>
          <div class="range-row">
            <input type="range" min="10" max="120" name="font_size" id="font_size" value="{{ config.font_size }}">
            <div class="range-value"><span id="fontSizeValue">{{ config.font_size }}</span> px</div>
          </div>
        </div>

        <div class="form-group full">
          <label>PrÃ©fixe du message <span class="hint">Ex : â€œTemps restant : â€</span></label>
          <input type="text" name="message_prefix" id="message_prefix" value="{{ config.message_prefix }}">
        </div>
	      
	      <!-- ICÃ”NE -->
        <div class="form-group">
          <label>IcÃ´ne</label>
          <input type="text" name="icon" id="icon" value="{{ config.icon }}" placeholder="ex : â³, ğŸ”¥, ğŸ‰">
        </div>

        <div class="form-group">
          <label>Position de lâ€™icÃ´ne</label>
          <select name="icon_position" id="icon_position">
            <option value="left"   {% if config.icon_position == 'left'   %}selected{% endif %}>Avant le texte</option>
	          <option value="right"  {% if config.icon_position == 'right'  %}selected{% endif %}>AprÃ¨s le texte</option>
	          <option value="above"  {% if config.icon_position == 'above'  %}selected{% endif %}>Au-dessus</option>
          </select>
        </div>

        <div class="form-group">
          <label>Padding (px)</label>
          <input type="number" name="padding" id="padding" value="{{ config.padding }}" min="0" max="100">
        </div>
	      
	      <!-- BLOCS -->
        <div class="form-group full">
          <label>Blocs (Blocks / Flip / Bubble)</label>
          <div class="template-badges">
            <span class="badge-template">Fond, contour, arrondis, espacementsâ€¦</span>
          </div>
        </div>

        <div class="form-group">
          <label>Fond blocs</label>
          <input type="color" name="block_bg_color" id="block_bg_color" value="{{ config.block_bg_color }}">
        </div>

        <div class="form-group">
          <label>Contour blocs</label>
          <input type="color" name="block_border_color" id="block_border_color" value="{{ config.block_border_color }}">
        </div>

        <div class="form-group">
          <label>Ã‰paisseur contour</label>
          <input type="number" name="block_border_width" id="block_border_width" value="{{ config.block_border_width }}" min="0" max="10">
        </div>

        <div class="form-group">
          <label>Rayon coins</label>
          <input type="number" name="block_radius" id="block_radius" value="{{ config.block_radius }}" min="0" max="60">
        </div>

        <div class="form-group">
          <label>Padding X blocs</label>
          <input type="number" name="block_padding_x" id="block_padding_x" value="{{ config.block_padding_x }}" min="0" max="80">
        </div>

        <div class="form-group">
          <label>Padding Y blocs</label>
          <input type="number" name="block_padding_y" id="block_padding_y" value="{{ config.block_padding_y }}" min="0" max="80">
        </div>

        <div class="form-group">
          <label>Espacement blocs</label>
          <input type="number" name="blocks_gap" id="blocks_gap" value="{{ config.blocks_gap }}" min="0" max="80">
        </div>
	      
	      <!-- LABELS -->
        <div class="form-group full">
          <div class="inline-row">
            <label>Labels J/H/M/S</label>
            <div class="inline-checkbox">
              <input type="checkbox" name="show_labels" id="show_labels" {% if config.show_labels %}checked{% endif %}>
              <span>Afficher</span>
            </div>
            <div class="inline-checkbox">
              <input type="checkbox" name="labels_custom" id="labels_custom" {% if config.labels_custom %}checked{% endif %}>
              <span>PersonnalisÃ©s</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Couleur labels</label>
          <input type="color" name="label_color" id="label_color" value="{{ config.label_color }}">
        </div>

        <div class="form-group">
          <label>Taille labels (facteur)</label>
          <input type="number" step="0.1" min="0.2" max="1.0" name="label_size_factor" id="label_size_factor" value="{{ config.label_size_factor }}">
        </div>

        <div class="form-group">
          <label>Texte â€œjoursâ€</label>
          <input type="text" name="label_days" id="label_days" value="{{ config.labels_personalized.days }}">
        </div>

        <div class="form-group">
          <label>Texte â€œheuresâ€</label>
          <input type="text" name="label_hours" id="label_hours" value="{{ config.labels_personalized.hours }}">
        </div>

        <div class="form-group">
          <label>Texte â€œminutesâ€</label>
          <input type="text" name="label_minutes" id="label_minutes" value="{{ config.labels_personalized.minutes }}">
        </div>

        <div class="form-group">
          <label>Texte â€œsecondesâ€</label>
          <input type="text" name="label_seconds" id="label_seconds" value="{{ config.labels_personalized.seconds }}">
        </div>
	      
	      <!-- BANNIÃˆRE -->
        <div class="form-group full">
          <label>BanniÃ¨re (template Banner)</label>
        </div>

        <div class="form-group">
          <label>Fond banniÃ¨re</label>
          <input type="color" name="banner_bg_color" id="banner_bg_color" value="{{ config.banner_bg_color }}">
        </div>

        <div class="form-group">
          <label>Texte banniÃ¨re</label>
          <input type="color" name="banner_text_color" id="banner_text_color" value="{{ config.banner_text_color }}">
        </div>
	      
	      <!-- PROGRESS BAR -->
        <div class="form-group full">
          <label>Barre de progression (template Progress)</label>
        </div>

        <div class="form-group">
          <label>Fond barre</label>
          <input type="color" name="progress_bg_color" id="progress_bg_color" value="{{ config.progress_bg_color }}">
        </div>

        <div class="form-group">
          <label>Remplissage barre</label>
          <input type="color" name="progress_fg_color" id="progress_fg_color" value="{{ config.progress_fg_color }}">
        </div>

        <div class="form-group">
          <label>Hauteur (px)</label>
          <input type="number" name="progress_height" id="progress_height" value="{{ config.progress_height }}" min="4" max="60">
        </div>

        <div class="form-group">
          <label>FenÃªtre max (jours)</label>
          <input type="number" name="progress_max_days" id="progress_max_days" value="{{ config.progress_max_days }}" min="1" max="365">
        </div>
	      
	      <!-- SUBMIT -->
        <button type="submit" class="btn-primary">
          <span>âœ¨ GÃ©nÃ©rer un nouveau countdown</span>
        </button>
      </form>
    </div>
	  
	  <!-- COLONNE DROITE : MINI + GRAND APERÃ‡U + LIEN -->
    <div class="preview-wrapper">

      <!-- MINI PREVIEW STICKY -->
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              <div class="card-title-icon">ğŸ”</div>
              Mini aperÃ§u
            </div>
            <div class="card-subtitle">
              AperÃ§u compact toujours visible pendant que tu modifies les options.
            </div>
          </div>
          <span class="badge-small">Live</span>
        </div>
        <div id="miniPreview">Choisis un template et une date pour voir lâ€™aperÃ§u.</div>
      </div>
	    
	    <!-- GRAND PREVIEW -->
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              <div class="card-title-icon">ğŸ‘ï¸</div>
              AperÃ§u dÃ©taillÃ©
            </div>
            <div class="card-subtitle">
              Simulation HTML du rendu final. Le GIF gÃ©nÃ©rÃ© utilisera ce style.
            </div>
          </div>
          <span class="badge-small">Auto-update â€¢ 1s</span>
        </div>
        <div id="htmlPreview">Choisis une date pour voir lâ€™aperÃ§u.</div>
      </div>
	    
	    <!-- LIEN GIF -->
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              <div class="card-title-icon">ğŸ”—</div>
              Lien GIF dynamique
            </div>
            <div class="card-subtitle">
              Utilise ce lien dans tes emails. Chaque ID est permanent et indÃ©pendant.
            </div>
          </div>
        </div>

        {% if img_link %}
          <div class="form-group">
            <label>URL du GIF</label>
            <input class="link-input" readonly value="{{ img_link }}" onclick="this.select();">
            <div class="helper-text">Clique pour sÃ©lectionner, puis copie/colle dans ton outil dâ€™emailing.</div>
          </div>

          <div class="form-group">
            <label>Code HTML Ã  intÃ©grer</label>
            <div class="code-block">
              &lt;img src="{{ img_link }}" alt="Countdown"&gt;
            </div>
          </div>
        {% else %}
          <div class="helper-text">
            Configure ton countdown puis clique sur <strong>â€œGÃ©nÃ©rer un nouveau countdownâ€</strong> pour obtenir lâ€™URL.
          </div>
        {% endif %}
      </div>

    </div>

  </div>
</div>

<!-- JS EXTERNE -->
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>
</body>
</html>